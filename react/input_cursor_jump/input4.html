<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Hello World</title>
</head>

<body>
  <div>
    <label>without setSelectionRange</label>
    <input id="input1" />
  </div>
  <div>
    <label>with setSelectionRange</label>
    <input id="input2" />
  </div>
  <script type="text/javascript">
    (function () {
      const inputEl = document.getElementById('input1');

      inputEl.addEventListener("input", (evt) => {
        console.log("Donny", evt.target.value, evt.target.selectionStart)
        alert(evt.target.value) // alert реально блокирует поток страницы
                                // Это в отличии от брейкпоинтах в девтулз.
        const val = evt.target.value;
        evt.target.value = val.toUpperCase();
        console.log("Kushner", evt.target.value, evt.target.selectionStart)
        alert(evt.target.value)
        requestAnimationFrame(() => {
          console.log("Joe")
          alert(evt.target.value)

          requestAnimationFrame(() => {
            console.log("Brandon")
            alert(evt.target.value)
          })
        })
      });
    })();

    (function () {
      const inputEl = document.getElementById('input2');

      inputEl.addEventListener("input", (evt) => {
        const caretPositionBefore = evt.target.selectionStart;
        const val = evt.target.value;
        inputEl.value = val.toUpperCase();
        inputEl.setSelectionRange(caretPositionBefore, caretPositionBefore);
      });
    })();
  </script>
</body>

</html>